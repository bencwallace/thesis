% Parts are the largest structural units, but are optional.
%\part{Thesis}

% Chapters are the next main unit.
\chapter{Introduction}
\label{sec:intro}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Thermodynamics originated as the study of heat and its transformations into other
forms of energy, but can more generally be described as the field of study that
is concerned with the properties of bulk matter. That is, it seeks to
answer questions regarding those properties of matter that are only well-defined
in terms of large collections of particles. Two familiar examples of
such properties are density and temperature. Density is usually defined as the mass
of a substance per unit volume at a certain temperature. Such a quantity is
sometimes said to be \emph{intensive}: it is a property of the substance itself,
not the amount of substance present.

There is a small caveat that should be added to this definition: the mass per unit
volume of a sample of a substance will only become independent of the volume once
this volume is sufficiently large. This makes density not only a property of the
substance, but in fact a \emph{macroscopic} property (as opposed to, e.g.\ the
atomic number of a substance). To say that thermodynamics is the study of bulk
matter amounts to saying that it deals in macroscopic quantities.
% Thus, it does not make sense to ask for the density of a sample of hydrogen consisting
% of a single atom although it is sensible to speak of the density of hydrogen.
% In this sense, density is not
% only a true property of the substance, but in fact a \emph{macroscopic} property
% (as opposed to, e.g.\ the atomic number of hydrogen) and thermodynamics is the
% study of macroscopic properties.

The fact that there even is such a notion as a macroscopic quantity
% of a substance
raises a number of simple questions. For instance, if these quantities
are indeed properties of the substance itself, then it should be possible to 
derive them from the microscopic properties of the substance's constituent particles;
yet above, we have resorted to discussing ``large'' quantities of substance in order
to make sense of density. In fact, this leads us to another natural question: what
constitutes a sample sufficiently large to be considered bulk matter and why should
certain measurements of a sample stabilize when the sample is sufficiently large?

A natural response to this last question is that some sort of law of large numbers
is at work. Although the behaviour of a system of particles is not random, it may
be that it is sufficiently complex that it is reasonable to view it as such.
This is the basic idea of statistical mechanics: to leverage the complexity of
large systems of particles in order to explain the apparent simplicity of bulk
matter as arising from a kind the kind of self-averaging that pervades probability
theory. From this point of view, macroscopic quantities are types of averages that
arise from some probability distribution.

A striking aspect of bulk matter is the
% that we have not yet discussed pertains to the
existence of different \emph{phases} of matter, which correspond to radically different
macroscopic behaviour. For instance, steam and water have very different densities despite
both being $\mathrm{H_2O}$. Of course, steam exists at much higher temperatures than water
and density, as we said above, is a function of temperature. However, one would not be
able to predict the density of steam by measuring the temperature-dependence of the
density of water.

% and the nature of \emph{phase transitions}.
In fact, the boiling of water is signalled by an abrupt drop in density by a factor
of around $1/1000$ at normal atmospheric pressure. The temperature at which water
boils varies as a function of pressure $T_c = T_c(P)$ and a \emph{phase transition}
is said to occur when the pressure or temperature are varied in such a way as to
cross the graph of this function; see Figure~\ref{fig:liquid-vapour}.
% Moreover, for any fixed $P$ there is a drop in density as the temperature is increased past $T_c(P)$.
Moreover, as $P$ is increased, the density difference along this curve decreases and
there is a \emph{critical point} $(T_c(P_c), P_c)$ at which this difference vanishes.

\begin{figure}
\centering
\label{fig:liquid-vapour}
\includegraphics{liquid_vapour}
\caption[Phase diagram of $\rm H_2 O$]{The phase diagram of $\rm H_2 O$}
\end{figure}

Since statistical mechanics deals with extremely large, complicated systems of
interacting particles, only simplified models of real materials can usually be
studied in detail. Such models are useful for building a
\emph{qualitative} understanding of the phases of matter and phase transitions.
However, the simplifications inherent in their definitions mean that they are
usually not suitable for making quantitative predictions.

A remarkable phenomenon, known as \emph{universality}, is that this is no longer
entirely true at the critical point. At criticality, many quantities behave in a
way that is independent of the fine details of the model under consideration. Thus,
some of the \emph{quantitative} properties of real materials can in principle be
predicted exactly by studying models whose only resemblance to these materials is
in their very coarse properties.

In the 1970's Ken Wilson, inspired by ideas in quantum field theory, gave an
explanation of universality in terms of an
abstract dynamical system on a space of models known as the \emph{renormalisation
group}. This idea was enormously successful and led to his 1982 Nobel Prize. In fact,
the renormalisation group has become a standard way of understanding critical phenomena
amongst physicists.

Nevertheless, a mathematically rigorous understanding of the renormalisation group
remains incomplete. Although there have been several rigorous implementations of
Wilson's ideas, they tend to be highly technical and restricted to somewhat special
classes of models. The main purpose of this thesis is to discuss extensions of an
approach of Bauerschmidt, Brydges, and Slade that have been used to study the
critical behaviour of a generalized $|\varphi|^4$ model and a model of weakly
self-avoiding walk with contact self-attraction (WSAW-SA). We will introduce these
models and our main results in the present chapter and discuss the proofs in the
remainder of the thesis.

We begin in Section~\ref{sec:asymp} with some general background on asymptotic
notation and the method of generating functions and Laplace transforms. In
Sectin~\ref{sec:gibbs}, we briefly introduce some of the basic ideas of equilibrium
statistical physics. The models we study are defined on graphs, which we
discuss in Section~\ref{sec:graphs}. We define spin systems, in particular
the $|\varphi|^4$ model, in Section~\ref{sec:spins}. Critical behaviour and
the renormalisation group is probably most easily explained in the context of such
systems, and we give an informal description of these ideas in Section~\ref{sec:crit}.
In Section~\ref{sec:walks},
we introduce the WSAW-SA and discuss its critical behaviour. This gives us all
the necessary definitions to state our main results in Section~\ref{sec:mr}.
Before proceeding to the method of proof,
we discuss the close relationship between models of walks and spin systems in
Section~\ref{sec:spin-walk}; in particular, we state a rigorous representation
of the WSAW-SA in terms of a spin system related to the $|\varphi|^4$ model
that allows us to unify our treatment of both models.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Asymptotics}
\label{sec:asymp}

We briefly describe some useful background on asymptotics.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Asymptotic notation}

Let $F$ and $G$ be a functions on a subset of the real line or the integers.
For $a\in[-\infty,\infty]$, we write
\begin{alignat}{2}
F(x) &\sim G(x), &&\qquad x \to a \\
F(x) &= o(G(x)), &&\qquad x \to a
\end{alignat}
if, respectively,
\begin{align}
&\lim_{x\to a} \frac{F(x)}{G(x)} = 1 \\
&\lim_{x\to a} \frac{F(x)}{G(x)} = 0.
\end{align}
We also write
\begin{equation}
F(x) = O(G(x))
	\text{ or }
F(x) \le O(G(x)),
	\qquad
x \to a
\end{equation}
if there is a constant $C \ge 0$ such that $F(x) \le C G(x)$ for all
$x$ in some neighbourhood of $a$ (in the extended real line). Lastly, we write
\begin{equation}
F(x) \asymp G(x),
	\qquad
x \to a
\end{equation}
if $F(x) = O(G(x))$ and $G(x) = O(F(x))$ as $x\to a$, possibly with
different constants for the two inequalities. We will sometimes write
$F(x) \approx G(x)$ in heuristic
arguments where the hope is that a rigorous argument might replace $\approx$
by $\asymp$ or $\sim$.
% We will often use $C, C', C_1, c$, etc.\ to denote a generic constant.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Generating function and Laplace transform}

The \emph{generating function} of a sequence $a_n$ is the function $g(z)$ defined
by the power series with coefficients $a_n$:
\begin{equation}
g(z) = \sum_{n=0}^\infty a_n z^n.
\end{equation}
If the function $g$ is sufficiently well understood, then the coefficients
can be recovered by differentiation:
\begin{equation}
a_n = \frac{1}{n!} g^{(n)}(0).
\end{equation}
This is known as the method of generating functions \cite{Wilf06}.

In many cases, $g$ cannot be computed exactly. Nevertheless, there is a close
relationship between the asymptotics of the sequence $a_n$
as $n\to\infty$ and the function $g(z)$ near its dominant singularities, i.e.\
its singularities closest to the origin \cite{FS09}.
For instance, if $a_n \sim r^{-n} n^\alpha$, then the root test implies that
the generating function $f$ has radius of convergence $r$. If, moreover, $a_n \ge 0$,
then $g(z) \sim C (r - z)^{-(\alpha+1)}$ as $z \uparrow r$.		% See Madras-Slade
This is an
example of an \emph{Abelian theorem}. The converse does not always hold; a
theorem providing conditions under which the converse is true is known as a
\emph{Tauberian theorem}, and is generally harder to prove than its Abelian
counterpart.

Likewise, the asymptotics of a function $f(T)$ as $T\to\infty$ can sometimes
be recovered from the behaviour of its \emph{Laplace transform}
\begin{equation}
\label{e:laplace-transform-def}
G(\nu) = \int f(T) e^{-\nu T} \; dT
\end{equation}
near $\nu_0 \coloneqq \inf \{ \nu : G(\nu) < \infty \}$.
There are Abelian and Tauberian theorems for the Laplace transform analogous
to those for generating functions. For instance,
$f(T) \sim A T^\alpha$ implies that $G(\nu) \sim A' (\nu - \nu_0)^{-(\alpha+1)}$
as $\nu\downarrow\nu_0$ and the converse holds when $f$ is monotone (see \cite{Widd41}).
% When this is not the case, one can attempt to recover the asymptotics of $f$ by
% inverting the Laplace transform.



% For instance, we have the following (see \cite[Chapter V]{Widd41}).
% 
% \begin{theorem}
% Suppose that there exist $\nu_0$ such that
% the function $G(\nu)$ defined by \eqref{e:laplace-transform-def} converges for
% $\nu > \nu_0$. If there exist $A$ and $\alpha \ge 0$ such that
% \begin{equation}
% f(T) \sim \frac{A}{\Gamma(\alpha + 1)} T^\alpha,
% \end{equation}
% then
% \begin{equation}
% G(\nu) \sim A \nu_0 (\nu - \nu_0)^{-(\alpha+1)}.
% \end{equation}
% Moreover, the converse holds if $f(T)$ is increasing.
% \end{theorem}
% 
% When $f$ is not monotonic, it may still be possible to recover its asymptotic
% behaviour from $G$ by inverting the Laplace transform. However, control over
% $G$ for $\nu$ in a sector of the complex plane is required in this case.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Equilibrium statistical mechanics}
\label{sec:gibbs}

Let $(\Omega, \lambda)$ be a measure space. We view $\lambda$ as some ``natural''
measure on $\Omega$. The dynamics of a physical system with state space $\Omega$
are often determined by a function $H$ on $\Omega$, known as the \emph{Hamiltonian}.
Typically, $H(\omega)$ represents the total energy of the system in state $\omega$;
it is thus reasonable to assume that $H$ is bounded below\footnote{It is convenient
to allow $H$ to take on negative values.}.

\begin{example}
\label{ex:hamilton}
The canonical example is a system of $n$ point particles in a domain $U \subset \R^3$,
for which $\Omega = (U \times \R^3)^n$ and $\lambda$ is Lebesgue measure on $\Omega$.
A state $\omega\in\Omega$ consists of the positions $q_i \in U$ and momenta $p_i \in \R^3$
of the $n$ particles. The Hamiltonian is usually smooth and the dynamics are determined
by Hamilton's equations
\begin{align}
\dd{q}{t} 	&= \nabla_p H \\
-\dd{p}{t} 	&= \nabla_q H.
\end{align}
Typically, the Hamiltonian has the form
\begin{equation}
\label{e:total-energy}
H(q, p) = \frac{1}{2m} |p|^2 + U(q).
\end{equation}
The first term is the usual definition of kinetic energy and the second term, which
depends only on $q$, is a potential energy function.
\end{example}

In statistical mechanics, the systems of concern consist of a very large number
of particles ($n$ large in the previous example); typically, the state space $\Omega$ is very
high-dimensional and it is infeasible to study the exact dynamics of such a system.

A common simplifying assumption is that after a long time has passed, the system
under consideration will settle into a state of \emph{thermal equilibrium}, meaning
that there is no net flow of heat between the system and its surroundings. Thus,
the temperature is constant and we denote by $\beta$ the \emph{inverse temperature}.
The \emph{Gibbs measure} \cite{Gibbs60} for a system with Hamiltonian $H$ at inverse temperature
$\beta$ is the probability measure on $\Omega$ given by
\begin{equation}
\label{e:gibbs-def}
\mu_\beta(d\omega) = \frac{1}{Z} e^{-\beta H(\omega)} d\lambda(\omega).
\end{equation}
The normalizing constant
\begin{equation}
Z = \int e^{-\beta H} \; d\lambda
\end{equation}
is known as the \emph{partition function}.

A simple approach to the derivation of this measure was suggested by Jaynes \cite{Jaynes57}:
amongst all probability measures $\mu$ on $\Omega$ absolutely
continuous with respect to $\lambda$, the Gibbs measure maximizes the \emph{entropy}
\begin{equation}
\label{e:entropy-def}
\entropy(\mu) = -\int \log \frac{d\mu}{d\lambda} \; d\mu
\end{equation}
with respect to $\lambda$, subject to the fixed average energy constraint
\begin{equation}
\label{e:fix-avg-energy}
\int H \; d\mu = E.
\end{equation}
This can be shown using the method of Lagrange multipliers;
the parameter $\beta = \beta(E)$ arises as a Lagrange multiplier.

% The \emph{free energy} is defined by
% \begin{equation}
% F_\beta = -\frac{1}{\beta} \log Z_\beta.
% \end{equation}
% A computation of the entropy of $\mu_\beta$ with $\beta = \beta(E)$ shows that
% \begin{equation}
% F_\beta = E - \frac{1}{\beta} \entropy(\mu_\beta),
% \end{equation}
% which recovers the usual definition of Helmholtz free energy in thermodynamics.

\subsection{Relation to quantum theory}
\label{sec:quantum}

Let us briefly describe the relationship between equilibrium statistical
mechanics and quantum field theory. Our presentation is heuristic and involves
manipulations of a priori ill-defined objects. A rigorous development of these
ideas goes back to \cite{Syma69,Nelson73,OS73,OS75}; useful references are
\cite{Simon05} (for quantum mechanics) and \cite{GJ87} (for quantum
field theory).

Let $H(x, p)$ be the Hamiltonian \eqref{e:total-energy} (we have written $x$
instead of $q$). In quantum mechanics, the state space is replaced by a Hilbert
space of functions over $\R^{6n}$, usually $L^2 = L^2(\R^{3n})$;
the position $x_j$ is replaced by the \emph{position operator} $\hat x_j$ given by
multiplication by $x_j$; and the momentum $p_j$ is replaced by the \emph{momentum
operator} $\hat p_j = -i \hbar \partial/\partial x_j$ (we ignore details regarding
the domains of these operators). The resulting operator $\hat H = H(\hat x, \hat p)$
on $L^2$ determines the evolution of the \emph{wave function} $\psi\in L^2$ via
the Schr\"{o}dinger equation
\begin{equation}
\dd{\psi}{t} = -\frac{i}{\hbar} \hat H \psi
\end{equation}
whose solution with initial condition $\psi(0)$ is given by
$\psi(t) = e^{-it\hat H/\hbar} \psi(0)$.

Suppose that the solution operator is an integral operator with kernel $K_t$,
\begin{equation}
e^{-it\hat H/\hbar} f = \int K_t(\cdot, y) f(y) \; dy.
\end{equation}
The Feynman path integral formulation of quantum mechanics involves writing
the kernel as
\begin{equation}
K_t(a, b)
	=
\int_{\cwalks_t(a, b)} e^{(i/\hbar) \int_0^t L(x(s), \dot x(s)) \; ds} \; \Dcal x,
\end{equation}
where $\cwalks_t(a, b)$ is a space of paths $[0, t] \to \R^{3n}$ from
$a$ to $b$ equipped with a ``Lebesgue measure'' $\Dcal x$ and
\begin{equation}
L(x, \dot x) = \frac{1}{2} m |\dot x|^2 - U(x)
\end{equation}
is the \emph{Lagrangian} of the classical system we started with.
As such, the integral representation of $K_t$ is ill-defined;
for instance, the measure $\Dcal x$ on paths does not exist. However, let us
not concern ourselves with this.

Suppose that $\psi$ can be analytically continued to a region of the complex
plane containing the positive imaginary axis. Then we might hope the function
$t \mapsto \psi(-it)$ has solution operator with kernel of the form
\begin{equation}
K_{-it}(a, b)
	=
\int_{\cwalks_{-it}(a, b)} e^{(i/\hbar) \int_0^{-it} L(x(s), \dot x(s)) \; ds} \; \Dcal x.
\end{equation}
By the change of variables $s = -iu$,
\begin{equation}
(i/\hbar) \int_0^{-it} L(x(s), \dot x(s)) \; ds
	=
(1/\hbar) \int_0^t L(\tilde x(u), i \dot{\tilde x}(u)) \; du
	=
-(1/\hbar) \int_0^t H(\tilde x(u), m \dot{\tilde x}(u)) \; du
\end{equation}
with $\tilde x(t) = x(-it)$. Thus, by the fictive change of variables in which
$\cwalks_{it}(a, b)$ is replaced by $\cwalks_t(a, b)$, we get
\begin{equation}
\label{e:heat-kernel-fake}
K_{-it}(a, b)
	=
\int_{\cwalks_t(a, b)} e^{-(1/\hbar) \int_0^t H(x(u), m\dot x(u)) \; du} \; \Dcal x
\end{equation}
This procedure is known as a \emph{Wick rotation}.

The analogue of this idea in quantum field theory involves replacing integration
over paths with integration over fields $\varphi$, which are functions on $\Rd$.
The corresponding ``measures'' of the form $e^{-(1/\hbar)\int H} \Dcal\varphi$
should be compared with the Gibbs measures \eqref{e:gibbs-def} with $\hbar$ playing
the role of temperature. Although $H$
has been replaced by the \emph{integral} $\int H$, we will discuss how natural
choices for the Hamiltonian in a Gibbs measure are given by \emph{sums} over
spaces of fields on discrete approximations to $\Rd$ (graphs).

\begin{rk}
In fact, it turns out that \eqref{e:heat-kernel-fake} is not too unreasonable.
For simplicity, let us take $\hbar = 1$ and $m = 1$.
Then we would expect $\tilde\psi$ to solve
\begin{equation}
\label{e:linear-pde}
\dd{\tilde\psi}{t} = -\hat H \tilde\psi.
% -\frac{1}{\hbar} \hat H \tilde\psi.
\end{equation}
When $U = 0$, we have $H(x, p) = |p|^2$, so $\hat H = -\tfrac12 \Delta_{\R^{3n}}$
is the Laplacian on $\R^{3n}$ and \eqref{e:linear-pde} is the heat equation.
On the other hand, $\int_0^t H$ is a positive-definite quadratic form, so
\eqref{e:heat-kernel-fake} is formally a Gaussian integral. This is consistent
with the well-known fact that a solution $\tilde\psi$ of the heat equation
on a domain can (under appropriate conditions) be written as
$\tilde\psi(t, x) = \Ex(\tilde\psi(0, B_t) \mid B_0 = x)$,
where $B_t$ is a Brownian motion.

More generally, for appropriate choices of $U \ne 0$, differential equations of
the form \eqref{e:linear-pde} can be expressed in terms
solutions to stochastic differential equations (this is the Feynman-Kac formula).
\end{rk}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Graphs}
\label{sec:graphs}

% Graphs are a useful setting for the definition of spatially-extended systems of particles.

An \emph{undirected graph} or simply a \emph{graph} is a pair $\graph = (\vertices, \edges)$,
where $\vertices$
is a set of \emph{vertices} and $\edges$ is a set of
\emph{edges} $\{ x, y \}$ with $x, y \in \vertices$; we will write $x \sim y$ if
$\{ x, y \} \in \edges$.
For simplicity, we will assume that $\vertices$ is countable and that there are no
\emph{self-loops} $\{ x \} \in \edges$.

A graph \emph{automorphism} is a function $f : \vertices\to\vertices$ such that
$x \sim y$ if and only if $f(x) \sim f(y)$.
We will assume that $\graph$ is \emph{transitive} meaning that for all pairs
of distinct
vertices $a, b \in \vertices$, there exists an automorphism $f$ with $f(a) = b$.
We fix a vertex $0\in\vertices$ whose precise choice is immaterial due to
transitivity.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Functions on graphs}

Let us denote the components of an element $\varphi \in (\R^n)^\vertices$ by
$\varphi^i_x \in \R$ for $x \in \vertices$ and $i = 1, \ldots, n$.
The Euclidean inner product and norm on $(\R^n)^\vertices$
are defined by
\begin{align}
\varphi\cdot\tilde\varphi
	&= \sum_{x\in\vertices} \varphi_x \cdot \tilde\varphi_y
  		= \sum_{i=1}^n \sum_{x\in\vertices} \varphi^i_x \tilde\varphi^i_x \\
|\varphi|^2
	&= \varphi \cdot \varphi.
\end{align}
A $\vertices\times\vertices$ matrix $M = (M_{xy})_{x,y\in\vertices}$ acts on $\varphi$
component-wise:
\begin{equation}
(M \varphi)_x = \sum_{y\in\vertices} M_{xy} \varphi_y.
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The graph Laplacian}

Let us say that a $\vertices\times\vertices$ matrix $M$ is \emph{indexed by} $\edges$
if $M_{xy} = 0$ if and only if $x \not\sim y$.
Throughout this chapter, we let $\jay$ be a matrix indexed by $\edges$ with nonnegative entries:
\begin{equation}
\jay_{xy} \ge 0.
\end{equation}
% Thus, $\jay_{xy} \ge 0$ with equality if and only if $x\not\sim y$.
The pair $(\graph, \jay)$ is an example of a \emph{weighted} graph.
We will usually denote this weighted graph simply as $\graph$, with $\jay$
implicit.

Let $\diag$ be the diagonal $\vertices\times\vertices$ matrix with diagonal entries
\begin{equation}
d_x = \diag_{xx} = \sum_{y \sim x} J_{xy},
\end{equation}
where the sum is over all vertices $y$ adjacent to $x$.
We say that $\graph$ is \emph{$d_0$-regular} if $d_x = d_y$ for all $x, y$.

The \emph{graph Laplacian} on $\graph$ is defined by
\begin{equation}
-\lap = \diag - \jay.
\end{equation}
An important case is when $\jay_{xy} = \1_{x\sim y}$, for which
\begin{equation}
\label{e:Deltaxy}
-\Delta_{xy} = d_x \1_{x=y} - \1_{x \sim y}.
\end{equation}
We also define the \emph{massive Laplacian} with squared \emph{mass} $m^2 > 0$ by
\begin{equation}
-\lap + m^2.
\end{equation}
Note that
\begin{equation}
\label{e:sbp-gen}
\varphi \cdot (-\lap \varphi)
  =
\frac{1}{2} \sum_{x,y\in\vertices} J_{xy} |\varphi_x - \varphi_y|^2
  \ge
0,
\end{equation}
so $-\lap$ is positive-semidefinite.

\begin{example}
We will often work on the discrete $d$-dimensional \emph{torus}
of side $L^N$, defined by
\begin{equation}
\label{e:Lambda-torus}
\Lambda = \Lambda_N = \Zd/L^N\Zd
\end{equation}
for integers $L > 1$ and $N \ge 0$.
We view $\Lambda$ as a graph with $\vertices = \Lambda$ and $x \sim y$ if
$x$ and $y$ are nearest neighbours in $\Lambda$. This graph is clearly transitive
and $d_x = 2d$.
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The Green function}

If $m^2 > 0$, then $-\lap + m^2$ is positive-definite, hence invertible with inverse
\begin{equation}
(-\lap + m^2)^{-1} = (m^2 + D)^{-1} \sum_{n=0}^\infty Z^n P^n,
\end{equation}
where
\begin{align}
Z = (m^2 + D)^{-1} D,
  \quad
P = D^{-1} J.
\end{align}
Let $z_x$ denote the diagonal elements of $Z$. The \emph{Green function}
of $\graph$ is the kernel of $(-\lap + m^2)^{-1}$, given by
\begin{equation}
\label{e:greendef}
C_{xy}
  =
(m^2 + d_x)^{-1} \sum_{n=0}^\infty z_x^n P^n_{xy}.
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Spin systems}
\label{sec:spins}

% We begin with a brief discussion of spin systems in finite volume.
% Excellent references are \cite{Georgii11} and \cite{FV17}.
Let us begin by discussing spin systems in \emph{finite} volume. That is, we
let
\begin{equation}
|\vertices| < \infty.
\end{equation}
Suppose that $S \subset \R^n$ is equipped with a measure $d\lambda^0$, let
$\Omega = S^\vertices$, and define the product measure
\begin{equation}
d\lambda(\varphi) = \prod_{x\in\vertices} d\lambda^0(\varphi_x)
\end{equation}
on $\Omega$. We refer to the elements of $\Omega$ as \emph{fields}
or \emph{spin configurations} on $\vertices$ with spins in $S$.

Let $H : \Omega \to \R$ be a function and suppose
that $e^{-H}$ is integrable with respect to $d\lambda$.
The \emph{spin system} with Hamiltonian $H : \Omega \to \R$ is given
by the Gibbs measure
\begin{equation}
\label{e:gibbs-spin}
d\mu_\beta(\varphi)
	=
\frac{1}{Z_\beta} e^{-\beta H(\varphi)} \; d\lambda(\varphi).
\end{equation}
We sometimes add an \emph{external field} $h \in \R$ by considering the measure
\begin{equation}
\label{e:gibbs-spin-ext}
d\mu_{\beta,h}(\varphi)
	=
\frac{1}{Z_{\beta,h}}
e^{-\beta \big(H(\varphi) - h \sum_{x\in\vertices} \varphi_x\big)} \; d\lambda(\varphi).
\end{equation}
We will mainly be concerned with \emph{ferromagnetic} spin systems, for which the
Hamiltonian has the form
\begin{equation}
H(\varphi) = -\varphi \cdot M\varphi,
	\quad
M_{xy} \ge 0.
\end{equation}
The total energy of such a system is a sum of contributions
of the form $-2 \varphi_x \cdot M_{xy} \varphi_y$ for $x \sim y$. Such a
contribution
attains its minimum when $\varphi_x = \varphi_y$ and its maximum when
$\varphi_x = -\varphi_y$. In this sense, it is energetically favourable
for spins to \emph{align} in ferromagnetic systems.

\subsection{Examples of spin systems}

Below we discuss some common examples of spin systems.
In many cases, we discuss Hamiltonians that depend on one or more parameters
for which adjusting the inverse temperature $\beta$ is equivalent to rescaling
these prameters. In these cases, we will fix
\begin{equation}
\label{e:beta-one}
\beta = 1
\end{equation}
without loss of generality.

\subsubsection{Gaussian measures}

Suppose $S = \R^n$ and $\lambda^0$ is Lebesgue measure. Then the Hamiltonian
$H$ must be bounded below for the Gibbs measure \eqref{e:gibbs-spin} to be
well-defined. Essentially the simplest class of
non-constant\footnote{The Gibbs measure with constant Hamiltonian is just the
product measure.} Hamiltonians
are positive-definite quadratic forms. These are given via a positive-definite
symmetric $\vertices\times\vertices$ matrix $C$, called the \emph{covariance}
matrix, and take the form
\begin{equation}
H_C(\varphi) = \frac{1}{2} \varphi \cdot C^{-1} \varphi.
\end{equation}
The corresponding Gibbs measures are \emph{Gaussian} measures.

The partition function can be computed explicitly and the Gibbs measure takes
the form
\begin{equation}
\label{e:gauss-density}
\frac{d\varphi}{\sqrt{\det(2\pi C)}}
e^{-\tfrac12 \varphi \cdot A \varphi}.
\end{equation}
\emph{Wick's theorem} gives an expression for the moments:
if $x_1, \ldots, x_{2p} \in \Lambda$, then
\begin{equation}
\label{e:wick}
\int d\mu_C(\varphi) \prod_{k=1}^{2p} \varphi^i_{x_k}
	=
\sum_\pi \prod_{kl\in\pi} C_{x_kx_l}
\end{equation}
where the sum is over all pairings $\pi$ of $\{1,\ldots,2p\}$ (i.e.\ partitions of
this set into $2$-element subsets).
% An important case is the \emph{massive Gaussian free field} on $\graph$,
% which is the $\gcc = 0$ case of the $|\varphi|^4$ model (with $\nu$ necessarily positive).
% Thus, the the covariance is equal to the massive Green function $C = (-\lap + \nu)^{-1}$.
% In particular, the only non-zero contributions to the sum in \eqref{e:wick}
% come from pairings $\pi$ consisting of edges in $X$.

\subsubsection{The $|\varphi|^4$ model}

As in the previous example, let $S = \R^n$ and $\lambda^0$ be Lebesgue measure.
The next step up in complexity is a quartic Hamiltonian. In particular, we have
the Hamiltonian for the \emph{lattice $|\varphi|^4$ model} or \emph{Ginzburg-Landau-Wilson model}:
\begin{equation}
\label{e:phi4-Ham}
H_{\gcc,\nu}(\varphi)
  =
\sum_{x\in\vertices}
\left(
  \frac{1}{4} \gcc |\varphi_x|^4
    +
  \frac{1}{2} \nu |\varphi_x|^2
    +
  \frac{1}{2} \varphi_x \cdot (-\lap \varphi)_x
\right),
\end{equation}
where $\gcc > 0$ and $\nu\in\R$.
The expression \eqref{e:phi4-Ham} should be compared with \eqref{e:total-energy}.
With $p = m \dot q$ in the latter expression, the kinetic energy takes the form
$\tfrac12 m |\dot q|^2$. The lattice analogue of this quantity in \eqref{e:phi4-Ham} is
\begin{equation}
\label{e:discrete-kinetic}
\frac12 \sum_{x\in\vertices} \varphi_x \cdot (-\lap \varphi)_x
	=
\frac14 \sum_{x\in\vertices} \sum_{y\sim x} (\varphi_y - \varphi_x)^2,
\end{equation}
where we have applied \eqref{e:sbp-gen} to get the right-hand side.

\begin{example}[The GFF]
With $g = 0$ and $\nu > 0$,
\begin{equation}
H_{0,\nu}(\varphi) = H_C(\varphi),
	\qquad
C = (-\lap + \nu)^{-1}.
\end{equation}
In other words, the $|\varphi|^4$ model becomes the Gaussian measure with covariance given
by the massive Green function. The corresponding spin system is the discrete massive
\emph{Gaussian free field} or \emph{GFF}.

The continuum analog of this model with mass $0$
(which can be defined for $d > 2$) is a simple example of a
non-interacting\footnote{The corresponding classical model only involves the kinetic term
\eqref{e:discrete-kinetic}.} quantum field theory. The $|\varphi|^4$ model was introduced
in attempts to construct an \emph{interacting} theory.
\end{example}

\subsubsection{The $O(n)$ spin model}

Consider the $|\varphi|^4$ model when $\graph$ is $d_0$-regular. In this case,
the Hamiltonian takes the form
\begin{equation}
\label{e:phi4-split}
H_{\gcc,\nu}(\varphi)
  =
\sum_{x\in\vertices} U_{\gcc,\nu}(\varphi_x) - \frac{1}{2} \varphi \cdot \jay \varphi,
\end{equation}
where the \emph{single-spin potential} $U_{\gcc,\nu}$ is given by
\begin{equation}
U_{\gcc,\nu}(t)
	=
\frac{1}{4} \gcc |t|^4
	+
\frac{1}{2} (\nu + d_0) |t|^2,
	\quad
t \in \R^n.
\end{equation}
We can see from \eqref{e:phi4-split} that the $|\varphi|^4$ model is ferromagnetic.
When $\nu + d_0 < 0$, the potential has the shape of a double well with roots at
$t = 0$ and on the sphere $|t| = \pm\sqrt{-2 (\nu + d_0) / \gcc}$.
Thus, as $\gcc\to\infty$ with $\nu = -(d_0 + \gcc/2)$, the Gibbs measure for the
$|\varphi|^4$ model converges to the Gibbs measure with Hamiltonian
\begin{equation}
\label{e:on-model}
H_J(\varphi) = -\frac12 \varphi \cdot J \varphi,
	\quad
\varphi \in (S^{n-1})^\vertices
\end{equation}
where $S^{n-1} \subset \R^n$ is the $(n-1)$-dimensional unit sphere.
This is known as the \emph{$O(n)$ spin model}. The special case $n = 1$ is the
famous \emph{Ising model}. The cases $n = 2$ and $n = 3$ are known as the
\emph{XY model} and the \emph{classical Heisenberg model}.

\begin{rk}
The Ising model on $\Zd$ (defined by a limiting procedure) was introduced
by Willhelm Lenz \cite{Lenz20}. Lenz
suggested it as a problem for his student Ernst Ising, who determined in 1924
\cite{Ising25} that there is no (non-trivial) phase transition when $d = 1$.
In \cite{Heisenberg28} Heisenberg, seeking a model that would possess a phase transition,
proposed the quantum version of his model (see \cite{Brush67} for a discussion on this).
Ironically, it turns out that the classical version of his model does not possess a phase
transition in both $d = 1$ and $d = 2$; and, moreover, in 1936
Rudolf Peierls \cite{Peierls36} put forth an argument for the existence of a phase transition
in the Ising model if $d > 1$. Peierl's argument was made rigorous in \cite{Griffiths64},
but even before that Onsager \cite{Onsager44} provided an exact computation of the
free energy in $d = 2$, which uncontrovertibly demonstrated the existence of a
phase transition in two dimensions.
The general $O(n)$ model was first studied in \cite{Stanley68}.
% In 1944, Onsager \cite{Onsager44} provided an exact calculation of the free
% energy in $d = 2$ with $h = 0$.
\end{rk}

\subsection{Phase transition in the Ising model}

In this section we discuss the phase transition for the Ising model on $\Zd$ with $d > 1$.
A good reference is \cite{FV17}.

% Let $\graph = B_N = [-N, N]^d \cap \Zd$
Let $\graph = \Lambda_N$
% and let $\partial V = \partial B_N$ be the external vertex boundary of $B_N$.
% For each $x\in\partial\vertices$, let $b_x \in \{-1, 0, 1\}$ be a choice of \emph{boundary condition}
and consider the Hamiltonian for the Ising model with an external field $h\in\R$:
\begin{equation}
H^{(N)}_h(\varphi)
	=
-\frac12 \sum_{x \sim y} \varphi_x \varphi_y
- h \sum_{x\in\vertices} \varphi_x,
% - \sum_{x\in\vertices} \varphi_x b_x
	\qquad
\varphi\in\{\pm1\}^\vertices.
\end{equation}
% This is a small generalization of the Hamiltonian \eqref{e:on-model}
% for the Ising model ($n = 1$) on $\vertices$ with $\jay_{xy} = \1_{x\sim y}$.
% 
% For now, let us employ \emph{free} boundary conditions $b \equiv 0$ (we will discuss
% other boundary conditions in Section~\ref{sec:dimension}).
Let $\langle\cdot\rangle^{(N)}_{\beta,h}$ denote the expectation with respect to
the corresponding Gibbs measure and let $Z^{(N)}_{\beta,h}$ be the partition function.
% A fundamental quantity for the detection of a phase transition in the Ising model is the
The \emph{free energy} is defined in finite volume by
\begin{equation}
F^{(N)}_{\beta,h}
	=
-\frac{1}{\beta |\vertices|} \log Z^{(N)}_{\beta,h}.
\end{equation}
Notice that with $h = 0$ a computation of the entropy $\entropy(\mu_{\beta,0})$
with $\beta = \beta(E)$ (as in \eqref{e:fix-avg-energy}) shows that
\begin{equation}
F^{(N)}_{\beta,0} = E - \frac{1}{\beta} \entropy(\mu_{\beta,0}),
\end{equation}
which recovers the usual definition of Helmholtz free energy in thermodynamics.

The \emph{magnetization} is given in finite volume by
\begin{equation}
M^{(N)}_{\beta,h}
	=
\frac{1}{|\vertices|} \sum_{x\in \vertices} \langle \varphi_x \rangle^{(N)}_{\beta,h}.
\end{equation}
Notice that
\begin{equation}
M^{(N)}_{\beta,h}
	=
-\ddp{}{h} F^{(N)}_{\beta,h}.
\end{equation}
When $h = 0$, the Gibbs measure is invariant under the spin-flip transformation
$\varphi \mapsto -\varphi$ and it follows that $M^{(N)}_{\beta,0} = 0$ for all $\beta$.

In order to study the dependence of the magnetization on $h$, we define the
\emph{magnetic susceptibility}
\begin{equation}
\chi^{(N)}(\beta, h)
	=
\frac{1}{\beta} \ddp{}{h} M^{(N)}_{\beta,h}.
\end{equation}
By translation-invariance,
\begin{equation}
\label{e:Ising-suscept}
\chi^{(N)}(\beta, h)
	=
\frac{1}{\beta^2}
\sum_{x\in\vertices} G^{(N)}_x(\beta, h),
\end{equation}
where
\begin{equation}
\label{e:Ising-2pt}
G^{(N)}_x(\beta, h)
	=
\langle \varphi_0 \varphi_x \rangle_{\beta,h}
	-
\langle\varphi_0\rangle_{\beta,h} \langle\varphi_x\rangle_{\beta,h}.
\end{equation}
These are all analytic functions.
In order to detect a phase transition, we must take the infinite-volume limit $N\to\infty$.

The infinite-volume free energy, magnetization, susceptibility, and two-point function
are defined as the $N\to\infty$ limits of their finite-volume counterparts; we denote them by
$F_{\beta,h}$, $M_{\beta,h}$, $\chi(\beta, h)$, and $G_x(\beta, h)$.
Let
\begin{equation}
M^\pm_{\beta} = \lim_{h\to0^\pm} M_{\beta,h}.
\end{equation}
Then when $\beta$ is sufficiently large, there is a non-zero \emph{spontaneous magnetization},
meaning that
\begin{equation}
M^-_\beta < 0 < M^+_\beta.
\end{equation}
That is, the magnetization is \emph{discontinuous} at $h = 0$. Equivalently, the free energy
is not differentiable\footnote{There is an interchange of limit and derivative implicit in
this statement, but it can be justified.} at that point. The \emph{critical point} for the
Ising model is the inverse temperature
\begin{equation}
\beta_c = \sup\{\beta > 0 : M^+_\beta = 0 \}.
\end{equation}
At the critical point, the magnetization is expected to be continuous but non-differentiable.
This is equivalent to the free energy being once- but not twice-differentiable.
It is predicted that the
susceptibility diverges as the critical point is approached, which corresponds to slow decay
of the two-point function. We will discuss this in more detail in Section~\ref{sec:crit}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Spin systems in infinite volume}

% The presence of a phase transition in a physical system is signalled by an
% abrupt change in an observable quantity with respect to a parameter.
A broad distinction can be made between \emph{first-order} phase transitions
in which the
free energy has discontinuous first derivative with respect to an external
field $h$ (recall \eqref{e:gibbs-spin-ext}) and \emph{continuous} phase
transitions, in which the free energy is differentiable but non-analytic.
As discussed above, the infinite-volume limit of the free energy must be taken
in order for a phase transition to manifest.

\commentbw{Say something or get rid of this.}

% The systems we have defined above all
% have smooth free energy since the Hamiltonians are smooth functions. The reason we cannot
% detect a phase transition in these systems is that they have been defined on finite volumes.
% This is also the reason that the magnetization of the Ising
% model in a finite volume is $0$ in the absence of a magnetic field, despite the fact that
% this is not true of a real ferromagnet. Thus, in order to study phase transitions, we are
% forced to consider spin systems on infinite graphs.

A systematic approach to this problem was developed in the work of Dobrushin \cite{Dobrushin68}
and Lanford and Ruelle \cite{LR69}. A comprehensive reference to this subject is \cite{Georgii11}
(see also \cite{LP76} for spin systems with unbounded one-dimensional spins).
Loosely speaking, they take as fundamental not the Hamiltonian
but rather a ``potential'', which is a collection of functions encoding the microscopic interactions
from which the Hamiltonian is to be defined; for instance, for the Ising model,
the Hamiltonian is a sum of contributions of the form $J_{xy} \sigma_x \sigma_y$ whenever
$x \sim y$. Given such a potential, a Hamiltonian can be defined on any
finite subgraph of $\graph$ and a probability measure on $\Omega$ is said to be a Gibbs
measure or Gibbs state whenever its finite-volume conditional measures are of the form \eqref{e:gibbs-spin}.
This is somewhat in the spirit of Kolmogorov's consistency conditions with the importance
difference that the resulting collection $\gibbs_\beta$ of Gibbs states at inverse temperature
$\beta$ need not consist of only a single element. This is significant due to the interpretation
of distinct elements of $\gibbs_\beta$ as corresponding to different phases.

For many systems of interest there is a critical inverse temperature $\beta_c$ such that
$|\gibbs_\beta| > 1$ if and only if $\beta > \beta_c$. The region $\beta > \beta_c$ is typically
associated with first-order phase transitions whereas continuous phase transitions usually occur
at the critical point $\beta_c$.

We will avoid the issue of existence and uniqueness of infinite-volume Gibbs
measures
by defining observable quantities of interest (e.g.\ the two-point function) in infinite
volume as limits of their finite-volume counterparts. These limits can alternatively be
described as expectations with respect to infinite-volume Gibbs measures when the latter
exist. Moreover, our focus is on the behaviour of spin systems at or above the critical
point. Thus, we need not concern ourselves with issues related to non-uniqueness of Gibbs
states.

\subsubsection{Translation-invariant systems}

Our interest will be in translation-invariant systems on $\Zd$, for which a particular
approach to infinite volume is especially convenient. We begin by letting $\Lambda_N$
be the discrete torus as in \eqref{e:Lambda-torus}. We view $\Lambda_N$
as a subset of $\Zd$ approximately centered at the origin (say as
$[-\frac12 L^N+1,\frac12 L^N]^d \cap \Z^d$ if $L^N$ is even
and as $[-\frac12 (L^N-1), \frac12 (L^N-1)]^d \cap \Z^d$ if $L^N$ is odd). This allows us to preserve
translation-invariance of the models that concern us when defining them in finite volume.

In particular, we will study a generalization of the $|\varphi|^4$ model whose Hamiltonian
on $\Lambda_N$ is given by
\begin{equation}
\label{e:Vdef1}
V_{\gcc,\gamma,\nu,N}(\varphi)
	=
\sum_{x\in\Lambda_N}
\left(
	\frac{1}{4} (\gcc - \gamma) |\varphi_x|^4
		+
	\frac{1}{2} \nu |\varphi_x|^2
		+
	\frac{1}{2} \varphi_x \cdot (-\Delta \varphi)_x
		+
	\frac{1}{4 d} \gamma (\nabla |\phi_x|^2)^2
\right),
\end{equation}
where
\begin{equation}
(\nabla |\phi_x|^2)^2
	=
\sum_{|e|=1} (\nabla^e |\phi_x|^2)^2
\end{equation}
and the discrete gradient is defined by
\begin{equation}
\nabla^e f_x = f_{x+e} - f_x.
\end{equation}
The expectation with respect to the corresponding Gibbs measure will
be denoted $\langle\cdot\rangle_{\gcc,\gamma,\nu,N}$.
We recover \eqref{e:phi4-Ham} when $\gamma = 0$ and $\graph = \Lambda_N$.

Following \eqref{e:Ising-suscept} and \eqref{e:Ising-2pt}, we define the
two-point function and susceptibility by
\begin{equation}
\label{e:two-point-function-phi4}
G_{x, N}(g,\gamma,\nu; n)
	=
\frac{1}{n} \pair{\varphi_0 \cdot \varphi_x}_{g,\gamma,\nu,N},
	\quad
G_x(g,\gamma,\nu; n)
	=
\lim_{N \to \infty} G_{x, N}(g,\gamma,\nu; n)
\end{equation}
and
\begin{equation}
\label{e:susceptibility-def}
\chi(\gcc, \gamma, \nu; n)
	=
\lim_{N\to\infty} \sum_{x\in\Lambda_N} G_{x,N}(\gcc, \gamma, \nu; n).
\end{equation}

\begin{rk}
We will be interested in the approach to the critical point from high temperature,
so we have omitted the term
$\langle \varphi_0 \rangle_{g,\gamma,\nu,N} \cdot \langle \varphi_x \rangle_{g,\gamma,\nu,N}$
which vanishes in this regime.
\end{rk}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Critical behaviour and universality}
\label{sec:crit}

Many systems exhibit singular behaviour at or near the critical temperature in
the form of power law scaling of various observable quantities. This is known as
\emph{critical behaviour}. For concreteness, we will discuss the generalized
$|\varphi|^4$ model on $\Zd$ given by \eqref{e:Vdef1}
% with $d > 1$ and
with $J_{xy} = \1_{x\sim y}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The critical point}

We follow the convention \eqref{e:beta-one} of setting $\beta = 1$ and seek a
phase transition for $|\varphi|^4$ model when the parameter $\nu$ is varied.
We define the \emph{critical point} by
\begin{equation}
% \label{}
\nu_c = \nu_c(\gcc, \gamma; n) = \inf \{ \nu : \chi(g, \gamma, \nu; n) < \infty \}.
\end{equation}
% Since the susceptibility can be written as the second derivative of the free energy
% with respect to an external field, there is a continuous phase transition at $\nu_c$.
By \eqref{e:susceptibility-def}, it is
reasonable to expect rapid (i.e.\ summable) decay of $G_x(g, \gamma, \nu; n)$ in $|x|$ for
$\nu > \nu_c$ and much slower decay at $\nu = \nu_c$.

In fact, the two-point function is expected to decay exponentially above $\nu_c$.
The \emph{correlation length} $\xi$ is defined to be the reciprocal of the exponential
rate of decay of the two-point function; concretely, we let
\begin{equation}
\label{e:cl-spins}
\xi(g, \gamma, \nu; n) = \limsup_{k\to\infty} \frac{-k}{\log G_{ke}(g, \gamma, \nu; n)},
\end{equation}
where $e \in \Zd$ is a unit vector whose choice is irrelevant by invariance of this model
under lattice rotations.
Roughly speaking, the correlation length acts as
a ``macroscopic length scale'' of the model; it is a measure of the largest scale at
which spins are very strongly correlated. Based on the above discussion, we expect $\xi$
to diverge as $\nu\downarrow\nu_c$. This divergence is one of the
key features of critical behaviour
% and is indicative of strong correlations at all scales.
A related quantity is the \emph{correlation length of order $p$}, defined by
\begin{equation}
\label{e:clp-spins}
\xi_p(g, \gamma, \nu; n)
	=
\left(\frac{\sum_{x\in\Zd} |x|^p G_x(g, \gamma, \nu; n)}{\chi(g, \gamma, \nu; n)}\right)^{1/p}.
\end{equation}

\begin{rk}
There is a simple heuristic relationship between $\xi$ and $\xi_p$. Suppose that
the two-point function decays exponentially at rate $1/\xi$, possibly with some
sub-exponential multiplicative correction; for instance, suppose that
\begin{equation}
G_x(g, \gamma, \nu; n) \approx C |x|^{-\alpha} e^{-|x|/\xi(g, \gamma, \nu; n)},
\end{equation}
in some sense, where $\alpha$ and $C$ are positive constants independent of $\nu$.
Then the main contributions to the numerator of
\eqref{e:clp-spins} should come from $|x| \le \xi = \xi(g, \gamma, \nu; n)$. For such $|x|$,
$G_x(g, \gamma, \nu; n) \approx C |x|^{-\alpha}$ and so
\begin{equation}
\sum_{x\in\Zd} |x|^p G_x(g, \gamma, \nu; n)
	\approx
C \sum_{|x| \le \xi} |x|^{-(\alpha-p)}
	\approx
C \xi(g, \gamma, \nu; n)^{-(\alpha-p)}.
\end{equation}
It follows then from the definition that
\begin{equation}
\xi^p_p(g, \gamma, \nu; n) \approx \xi^p(g, \gamma, \nu; n).
\end{equation}
\end{rk}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Critical behaviour}

For simplicity, let us drop $\gcc$, $\gamma$, and $n$ from the notation.
It is predicted that there exist constants $\eta$, $\gammabar$, and $\nubar$
(unrelated to $\gamma$ and $\nu$), known as \emph{critical exponents}, such that
\begin{align}
\label{e:Gpred}
G_x(\nu_c)
	&\sim
C_1 |x|^{-(d - 2 + \eta)},
	\qquad
|x|\to\infty \\
\chi(\nu)
	&\sim
C_2 (\nu - \nu_c)^{-\gammabar},
	\qquad
\nu\downarrow\nu_c \\
\xi(\nu)
	&\sim
C_3 (\nu - \nu_c)^{-\nubar},
	\qquad
\nu\downarrow\nu_c \\
\label{e:xippred}
\xi_p(\nu)
	&\sim
C_4 (\nu - \nu_c)^{-\nubar},
	\qquad
\nu\downarrow\nu_c
\end{align}
where the $C_i$ are constants that may depend on $g$ and $n$ (and $p$ when $i = 4$).
The critical exponents, on the other hand, are expected to be \emph{universal} in the
sense that they only depend on ``large-scale properties'' of the model such as its
symmetries and the global geometry of the underlying graph. In particular,
for the $n$-component $|\varphi|^4$ model on $\Zd$, these exponents should only
depend on $n$ and $d$ and be independent of $g$ and $\gamma$ when $g > 0$ and $\gamma$
is sufficiently small (depending on $g$). In fact,
analogous relations are expected to hold for the $O(n)$ spin model, with the
\emph{same} critical exponents.

These and other relations are all believed to be manifestations of the existence of
a universal \emph{scaling limit} for the $|\varphi|^4$ model and other models in its
\emph{universality class}. That is, any spin system in this class, when appropriately
rescaled, is expected to converge in distribution to a unique continuum random field.
In this sense, the study of critical behaviour involves far-reaching generalizations
of the central limit theorem.

\begin{example}[The Gaussian free field]
\label{ex:gff-asymp}
On $\Zd$, \eqref{e:greendef} and \eqref{e:wick} imply that
\begin{equation}
G_x(0, 0, m^2; n)
	=
(m^2 + 2 d)^{-1} \sum_{k=0}^\infty z^k P^k_{0x},
\end{equation}
where $z = 2 d / (m^2 + 2 d)$ and $P = (2 d)^{-1} J$
is the transition matrix for the simple random walk $X$ on $\Zd$.
Thus, for $m^2 > 0$,
\begin{equation}
\chi(0, 0, m^2; n)
  % =
% \sum_{x\in\vertices} (-\Delta + m^2)^{-1}_{0x}
  =
(m^2 + 2 d)^{-1} \sum_{k=0}^\infty z^k
  =
(m^2 + 2 d)^{-1} (1 - z)^{-1}.
\end{equation}
It follows that $\nu_c(0, 0; n) = 0$ and $\gammabar = 1$ for this model.
It can also be shown that $\nubar = 1/2$ and $\eta = 0$ in this case
(e.g.\ see \cite{Lawl85} for $\eta$). In Appendix~\ref{sec:freeclp}, we give a new
proof that $\nubar = 1/2$ for $\xi_p(0, 0, m^2; n)$.
% For $d > 2$, the simple random walk is transient. Thus, letting $E_x$ denote the expectation
% of $X$ conditioned so that $X_0 = x$,
% \begin{equation}
% \sum_{n=0}^\infty P^n_{xy} = E_x \sum_{n=0}^\infty \1_{X_n=y} < \infty
% \end{equation}
% and we can define the \emph{massless} Gaussian free field on $\Zd$ to be the Gaussian
% measure with covariance $(-\Delta)^{-1}$. It is a well-known fact that
% \begin{equation}
% (-\Delta + m^2)^{-1}_{0x} \sim C |x|^{-(d-1)/2} e^{-m |x|}
% \end{equation}
% and
% \begin{equation}
% (-\Delta)^{-1}_{0x} \sim C' |x|^{-(d-2)}
% \end{equation}
% corresponding to $\gcc = \gamma = 0$
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Critical exponents}
\label{sec:dimension}

As mentioned above, the critical exponents are generally expected to depend on
$d$ and $n$. Below we discuss some of the conjectured values and known results.

\subsubsection{Dimension $d = 1$}

In $d = 1$, nearest-neighbour models typically do not possess a phase transition.
However, phase transitions may occur for sufficiently long-range models \cite{Dyso69}.

\subsubsection{Dimensions $d = 2$}

In $d = 2$, the Mermin-Wagner theorem \cite{MW66} implies that the $O(n)$ model does
not possess a first-order phase transition for $n > 2$. The case $n = 2$ is expected
to possess a \emph{Kosterlitz-Thouless} phase transition \cite{KT73}
(Kosterlitz and Thouless, together with Duncan Haldane, were awarded
the 2016 Nobel Prize in Physics for this and related ideas). Rigorous results relating
to this kind of phase transition include \cite{FS81,Falc12,Falc13}.
For $n = 1$, there is a phase transition; in fact, Onsager \cite{Onsager44} gave an
exact formula for the free energy of the Ising model.

The $1$-component planar models are expected to possess \emph{conformally invariant}
scaling limits. As a consequence of these conformal symmetries,
the predicted critical exponents are the rational numbers $\gammabar = 56/32$, $\nubar = 1$,
and $\eta = 1/4$. Recent years have shown rapid progress in this direction, stimulated
by the identification by Schramm \cite{Schramm00} of a $1$-parameter family of
conformally invariant random planar curves now known as the \emph{Schramm-Loewner
evolution} with parameter $\kappa$ or $\SLE_\kappa$. It was shown in \cite{CDHKS14}
that the interface curve (between $+ 1$ and $-1$ spins) for the Ising model on a
bounded simply connected domain with Dobrushin boundary
conditions\footnote{Positive spins along one side of the
boundary and negative spins on the other.} converges to $\SLE_3$ in
an appropriate scaling limit.

% The critical exponents for the $|\varphi|^4$ model (with $g > 0$ and $\gamma$ small)
% and the $O(n)$ spin model are conjectured to take on the following values:
% \begin{equation}
% \eta =
% 	\begin{cases}
% 	\frac{5 + n}{24},		& d = 2, \, n = 1 \\
% 	\approx 0.03,			& d = 3, \\
% 	0,						& d \ge 4
% 	\end{cases}
% \qquad
% \gamma =
% 	\begin{cases}
% 	\frac{43 + 13 n}{32},	& d = 2, \, n = 1 \\
% 	\approx 1,				& d = 3 \\
% 	1,						& d \ge 4
% 	\end{cases}
% \end{equation}
% and
% \begin{equation}
% \nubar =
% 	\begin{cases}
% 	\frac{3 + n}{4},		& d = 2, \, n = 1 \\
% 	\approx 0.6,			& d = 3 \\
% 	\frac{1}{2},			& d \ge 4
% 	\end{cases}
% \end{equation}
% with logarithmic corrections in $d = 4$.
% Thus, it is expected that, when $d > 4$, the critical exponents cease to depend
% on the dimension and $n$. In fact, they are expected to equal the exponents of
% the corresponding non-interacting model, the Gaussian free field.

\subsubsection{Dimension $d=3$}

Three-dimensional models are very poorly understood and only numerical approximations
are available for their critical exponents. In fact, it was only recently proved
that the Ising model's spontaneous magnetization vanishes continuously at
the critical point in three dimensions \cite{ADS15}.

\subsubsection{Dimensions $d > 4$}

If $d > 4$, the critical exponents for the $O(n)$ and $|\varphi|^4$ models are
predicted to become independent of $d$ and $n$ and to take on the values of the
corresponding exponents for the Gaussian free field, i.e.\ $\gammabar = 1$,
$\nubar = 1/2$, and $\eta = 0$.
This phenomenon is known as \emph{mean-field behaviour} and dimension $4$ is
called the \emph{upper-critical dimension} for this class of models.
For $n = 1, 2$ it is known that $\eta = 0$
for the \emph{continuum limit} of these models \cite{Aiz82,Fro82} if it exists.
On the lattice, Sakai proved that $\eta = 0$ for the Ising model \cite{Sakai07}
and the $1$-component $|\varphi|^4$ model \cite{Sakai15}.
Extensions to $n = 1, 2$ are upcoming in \cite{BHH17}.

\subsubsection{Dimension $d = 4$}

Dimension $4$ is the case of primary interest in quantum field theory, where one
dimension plays the role of time (this becomes a spatial dimension after a Wick
rotation as in Section~\ref{sec:quantum}).
It is predicted in dimension $4$ that a number of observables possess multiplicative
logarithmic corrections to mean-field sclaing. An exception is the two-point function,
which is expected to undergo
mean-field scaling ($\eta = 0$); this was shown for the $1$-component $|\varphi|^4$
model in \cite{GK85} and \cite{FMRS87}. Logarithmic corrections to scaling of the
susceptibility and correlation length of the $1$-component model were identified in
\cite{Hara87,HT87}.

Recently, Bauerschmidt, Brydges, and Slade \cite{BS-rg-norm,BS-rg-loc,BBS-rg-pt,BS-rg-IE,BS-rg-step}
have developed a renormalisation group
method for studying the $n$-component $|\varphi|^4$ model in $4$ dimensions; this
method works for any $n$ and, in a certain sense, extends to models of
self-interacting walks, interpreted as $n = 0$ (more on this in
Sections~\ref{sec:walks}--\ref{sec:spin-walk}).
In particular, they identified logarithmic corrections to scaling of the susceptiblity
and specific heat \cite{BBS-phi4-log}. Using an extension of this method, Slade and
Tomberg computed asymptotics for critical correlation functions in \cite{ST-phi4};
in particular, they showed that $\eta = 0$.
In this thesis, we discuss extensions of this method that have been used to study
the finite-order correlation length \cite{BSTW-clp} as well as more general models
of walks \cite{BSW-saw-sa}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The renormalisation group}
\label{sec:rg-intro}

In \cite{Kada66}, Leo Kadanoff considered a coarse-graining procedure for
studying the Ising model in which disjoint
blocks in $\Zd$ of side $L \ll \xi$ are replaced by single spins. He argued
that spins inside such blocks are so strongly correlated that the model
obtained by making this replacement should behave approximately like an Ising
model with new (``renormalized'') couplings.

At the critical point, $\xi = \infty$ this transformation
$T$ can be iterated indefinitely resulting in a dynamical system on a space
of models: the one-parameter semigroup $(T^j)_{j\in\Z_+}$ is known as the
\emph{renormalisation group}\footnote{The name
renormalisation \emph{group} is attributed by Wilson in \cite{Wils71I}
to the work of Gell-Mann and Low \cite{GML54}.}. This was the basis for Ken Wilson's
generalizations of Kadanoff's idea in \cite{Wils71I,Wils71II}.

The coarse-graining procedure of Kadanoff can be viewed as an approximate
method for computing integrals with respect to a Boltzmann weight $e^{-\beta H}$
by successively integrating out fluctuations that are ``small'' in the sense
that they are localized in space. In Wilson's approach fluctuations are instead
localized in Fourier space. Both approaches can be thought of
as corresponding to different types of covariance decompositions (see \cite{BCGNOPS78}).

Wilson's method results in a dynamical system on a space of
models that acts by appropriately integrating out small fluctuations, followed
by a rescaling step used to make this system autonomous (i.e.\ independent of
the ``scale'' $j$). He argued that the action of this dynamical system would
leave the long-range behaviour of the models invariant. Consequently, critical models
lying in the same orbit would belong to
the same universality class. Thus, such models should possess the same critical
exponents and scaling limit. Moreover, this scaling limit should be invariant
under the action of the renormalisation group, i.e.\ it should arise as a fixed
point of this dynamical system. Therefore, the set of points that flow towards it
form its stable manifold.

In addition to these rather broad statements regarding the nature of universality
and scaling limits, Wilson demonstrated that critical exponents could be computed
by a careful analysis of the asymptotics of the renormalisation group near its
fixed points. He claimed that such an analysis could be performed by approximating
this infinite-dimensional dynamical system by a \emph{finite-dimensonal} system.

By analyzing this finite-dimensional approximation, Wilson determined that there
is a unique hyperbolic fixed point in dimensions $d > 4$ corresponding to the Gaussian
free field and mean-field behaviour. As the dimension is lowered below $4$, a
bifurcation occurs in which the Gaussian fixed point splits into two fixed points.
One of these corresponds to Gaussian behaviour but is unstable. The other is hyperbolic and
corresponds to anomalous scaling behaviour; it is sometimes known as the
\emph{Wilson-Fisher} fixed point \cite{WF72}. At the bifurcation point $d = 4$, there is only
one (Gaussian) fixed point and logarithmic corrections to mean-field scaling arise
from the fact that this fixed point is not hyperbolic.

There are many difficulties in making Wilson's ideas rigorous and many approaches
have been tried. For instance, a rigorous implementation of Kadanoff's \emph{block-spin}
renormalisation group was developed in \cite{GK85}. Related ideas can also be found in
\cite{GJ87,FMRS87}. This thesis concerns the renormalisation group method Bauerschmidt,
Brydges, and Slade \cite{BS-rg-norm,BS-rg-loc,BBS-rg-pt,BS-rg-IE,BS-rg-step}, which we
will discuss further in Section~\ref{sec:rg}.

\begin{example}
\commentbw{CLT: Koralov-Sinai, Li-Sinai. See also Jona-Lasinio I think.}
\end{example}

% These notes discuss the renormalisation group
% on the Euclidean lattice as well as on a \emph{hierarchical} lattice, where
% the analysis is much simpler.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Self-interacting walks}
\label{sec:walks}

% \subsection{Discrete-time walks}

% Let $[n] = \{0,\ldots,n\}$ and call a function $\omega : [n]\to\vertices$
% a \emph{discrete-time walk of length $n$} if $\omega_i \sim \omega_{i+1}$ for all
% $i\in[n-1]$.
% A model of discrete-time walks can be defined by an assigning of weights
% $w_n : \dwalks_n \to \R$ for each $n \in \Z_+$, where $\Wcal_n$ is the
% collection of discrete-time walks $\omega$ of length $n$ with $\omega_0 = 0$.
% When these weights are nonnegative and summable, this is equivalent to
% equipping each $\Wcal_n$ with a probability measure; such \emph{probabilistic}
% models of walks are often closely related to ferromagnetic spin systems,
% as we will discuss in Section~\REF.

% In this thesis, we focus on continuous-time walks, which we define in the next
% section. Before proceeding, however, we discuss the following important example.

We begin with the following example.

\begin{example}[Self-avoiding walk]
Let $\omega : \{0,\ldots,n\} \to \vertices$ be a \emph{discrete-time walk}
of length $n$ on $\graph$, meaning that $\omega_i \sim \omega_{i+1}$ for all $i$. Let us
denote by $\dwalks_n$ the collection of such walks and set $\dwalks = \bigcup_n \dwalks_n$.
We say that $\omega$ is \emph{self-avoiding} if $\omega_i \ne \omega_j$
for all $i \ne j$. Let $\Scal_n$ denote the collection of $n$-step
self-avoiding walks with $\omega_0 = 0$. We equip $\Scal_n$ with the uniform
measure for each $n$. This gives us a simple model of a linear polymer.
% defined by the weights $w(\omega) = \1_{\omega\in\Scal_n}$.

% Equivalently, we equip $\Scal_n$ with the uniform measure $\mu_n$ for each $n$.
The uniform measures do not form a consistent family due to the possibility of ``traps''.
That is, the equality
\begin{equation}
\label{e:consistent-fam}
\mu_{|\omega|}(\omega) = \sum_{\bar\omega \supset \omega} \mu_{|\bar\omega|}(\bar\omega)
\end{equation}
does not hold for all $\omega\in\dwalks$ (the sum here is over all self-avoiding walks extending $\omega$).
For instance, consider the self-avoiding walk $\omega\in\dwalks_7$
on $\Zd$ in Figure~\ref{fig:trap}. This walk has positive probability under $\mu_7$ but,
since there are no self-avoiding walks extending $\omega$, the sum on the 
right-hand side of \eqref{e:consistent-fam} is $0$.

\begin{figure}[!htb]
\label{fig:trap}
\centering
\includegraphics{trapped_compact}
\caption[Trapped SAW]{A trapped self-avoiding walk}
\end{figure}

As a result, there is no straightforward way to apply the usual methods of stochastic processes
to study the self-avoiding walk. The existence of traps also contributes to the
combinatorial difficulty of this model; for instance, if $c_n = |\Scal_n|$, then it is
not clear how to express $c_{n+1}$ as a simple function of $c_n$.

We do know, however, that the sequence $c_n$ is sub-multiplicative: $c_{m+n} \le c_m c_n$.
This follows from the fact that a self-avoiding walk can be split into two self-avoiding
walks at any point along it, but the concatenation of two self-avoiding walks is not
necessarily self-avoiding. Thus, $\log c_n$ is subadditive and
Fekete's lemma for subadditive sequences implies the existence of the limit
\begin{equation}
c(\graph) = \lim_{n\to\infty} n^{-1} \log c_n.
\end{equation}
We call $c(\graph)$ the \emph{connective constant} of $\graph$.
% Note that, by the trivial bounds $1 \le c_n \le d_0^n$ for $n \ge 1$, $c(\graph) \in [0, d_0]$.
By definition, $c(\graph)$ is the exponential growth rate of $c_n$.
% $c_n \approx c(\graph)^n$ for large $n$.
% By definition, the susceptibility has radius of convergence $c(\graph)^{-1}$.
\end{example}

More general models of walks can be defined via measures on $\dwalks_n$. In fact,
it is sometimes more convenient to discuss models of walks parameterized by an
interval $[0, T]$. In both cases, we can conveniently define Gibbs measures
directly in infinite-volume with respect to the base measure induced by simple
random walk. Instead of discussing general models, we will proceed directly to
the model of interest in this thesis.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \subsection{Continuous-time walks}

% Let $\omega : [0, T] \to \vertices$ be a right-continuous function and define
% $\tau_n = \tau_n(\omega)$ inductively by setting $\tau_0 = 0$ and
% \begin{equation}
% \tau_{n+1} = \inf (t > \tau_n : \omega_t \ne \omega_{\tau_n}).
% \end{equation}
% Call $\omega$ a \emph{continuous-time walk of length $T$} if $\{ \tau_n \}$
% has no cluster points and $\omega_{\tau_i} \sim \omega_{\tau_{i+1}}$ for all $i$.
% Let $\cwalks_T$ denote the collection of continuous-time walks $\omega$ of length $T$
% with $\omega_0 = 0$. Let $E_0$ denote the expectation with respect to a continuous-time
% simple random walk on $\graph$ conditioned to start at $0$. This is the $\vertices$-valued
% Markov process $X$ with generator $-\lap$. In other words,
% \begin{equation}
% \Pr(X_t = y \mid X_0 = x) = (e^{-t \lap})_{xy}.
% \end{equation}
% Given a Hamiltonian $H$ on $\cwalks = \bigcup_{T \ge 0} \cwalks_T$,
% we can consider the Gibbs measures
% \begin{equation}
% \label{e:gibbs-walks}
% \mu_{\beta,T}(A) = \frac{1}{c_T} E_0 (e^{-\beta H} \1_A),
% 	\qquad
% c_T = E_0 (e^{-\beta H}).
% \end{equation}
% % We also have a \emph{grand ensemble} on all of $\cwalks$ defined by
% % \begin{equation}
% % \mu_\beta(A) = \frac{1}{\chi(\beta, \nu)} E_0 (e^{-\beta H - \nu |\omega|} \1_A)
% % \end{equation}
% % where $\nu\in\R$ is a parameter and $|\omega|$ is the length of $\omega$. The
% % partition function
% % \begin{equation}
% % \chi(\beta, \nu) = E_0 (e^{-\beta H - \nu |\omega|})
% % \end{equation}
% % is referred to as the \emph{susceptibility}.
% Rather than continuing to discuss such models in generality, we will proceed directly to
% our example of primary interest.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Weakly self-avoiding walk with self-attraction}

Let $X$ denote the continuous-time simple random walk on $\graph$ conditioned
to start at $0$. This is the $\vertices$-valued Markov process $X$ with generator
$-\lap$. In other words,
\begin{equation}
\Pr(X_t = y \mid X_0 = x) = (e^{-t \lap})_{xy}.
\end{equation}
Define the \emph{local time} up to time $T$ of $\omega \in \cwalks$ at
$x \in \vertices$ by
\begin{equation}
\label{e:LTx-def}
\lt^x_T(\omega) = \int_0^T \1_{\omega(S)=x} \; dS.
\end{equation}
Note that $\lt^x_T$ is almost surely finite.
% In the discrete-time case, $\lt^x_n$ is the number of times $\omega$ visits $x$
% and is bounded by $n$.
% In the continuous-time case, $\lt^x_T$ is almost surely
% finite for the continuous-time simple random walk.
We define the \emph{intersection local time}
\begin{equation}
\label{e:ITdef}
I_T(\omega)
	=
\int_0^T \!\! \int_0^T \1_{\omega(S_1)=\omega(S_2)} \; dS_1 dS_2
	=
\sum_{x\in\vertices} (\lt^x_T)^2
\end{equation}
and the \emph{contact self-attraction}
\begin{equation}
\label{e:CTdef}
C_T(\omega)
	=
\int_0^T ds \int_0^T dt \; \1_{\omega_s \sim \omega_t}
	=
\sum_{x \in \vertices} \sum_{y \sim x} \lt_T^x(\omega) \lt_T^y(\omega)
\end{equation}
up to time $T$.
% Recall that we have set the inverse temperature equal to $1$.

Given a parameter $\gcc > 0$, and $\gamma \in \R$, let
\begin{equation}
\label{e:Udef-neg}
U_{\gcc,\gamma}(f)
=
\gcc \sum_{x\in\vertices} f_x^2
- \frac{\gamma}{2d}
\sum_{x\in\vertices} \sum_{y \sim x} f_x f_y
\end{equation}
for $f : \vertices \to \R$.
The \emph{weakly self-avoiding walk with self-attraction} (WSAW-SA) is defined
by the Hamiltonian
\begin{equation}
\label{e:V}
U_{\gcc,\gamma,T}
	= U_{\gcc,\gamma} \circ L_T
	= \gcc I_T - \frac{\gamma}{2 d} C_T
\end{equation}
which induces a Gibbs measure with respect to the measure of $X$.
We will refer to the case $\gamma = 0$ as the \emph{weakly self-avoiding walk} (WSAW).

\begin{figure}[!htb]
\centering
\label{fig:domb-joyce}
\includegraphics{domb-joyce-black-small.png}
\caption[Discrete WSAW]{Monte Carlo simulation of discrete-time WSAW with 100 steps}
\end{figure}

We let
\begin{equation}
\label{e:c}
c_T = E_0\left(e^{-U_{\gcc,\gamma,T}}\right),
	\quad
c_T(x) = E_0\left(e^{-U_{\gcc,\gamma,T}}\1_{X_T = x}\right).
\end{equation}
The \emph{two-point function} and \emph{susceptibility} are defined
as the Laplace transforms of these weights:
\begin{align}
\lbeq{Gsa}
G_x(\gcc,\gamma,\nu)
    &=
\int_0^\infty c_T(x) e^{-\nu T} \; dT
\end{align}
and
\begin{equation}
\label{e:suscept-def}
\chi(\gcc, \gamma, \nu)
	=
\int_0^\infty c_T e^{-\nu T} \; dT
	=
\sum_{x\in\Zd} G_x(\gcc,\gamma,\nu),
\end{equation}
Note that \eqref{e:susceptibility-def} is more-or-less consistent with \eqref{e:susceptibility-def}
We will establish an exact analogue of \eqref{e:susceptibility-def} in Proposition~\ref{prop:finvol}.
The relationship between the two-point for walks and spin systems will be
discussed in Section~\ref{sec:intrep}.

We also have a version of the the \emph{correlation length of order $p$}:
\begin{align}
\label{e:clp-wsawsa}
\xi_p(\gcc, \gamma, \nu)
	&=
\left(\frac{\sum_{x\in\Zd} |x|^p G_x(g, \gamma, \nu)}{\chi(g, \gamma, \nu)}\right)^{1/p}.
\end{align}
Note that
\begin{equation}
\xi_p^p(\gcc,\gamma,\nu)
	=
\frac
{\int_0^\infty \langle |X(T)|^p \rangle c_T e^{-\nu T} \; dT}
{\int_0^\infty c_T e^{-\nu T} \; dT}.
\end{equation}
On $\Zd$, a version of the correlation length can be defined exactly as in \eqref{e:cl-spins}.

\begin{rk}
The discrete-time version of the WSAW-SA is straightforward to define in terms of
discrete-time simple random walk; when
$\gamma = 0$, it is known as the \emph{Domb-Joyce model} or \emph{discrete-time
weakly self-avoiding walk}. A sample of the Domb-Joyce model with 100 steps is shown
in Figure~\ref{fig:domb-joyce}. The SAW can be recovered as an
appropriate limit of the Domb-Joyce model or the continuous-time WSAW \cite{BDS12}.
\end{rk}

\subsubsection{Alternative representation}

For $f : \Zd \to \R$, let 
\begin{equation}
|\nabla f_x|^2 = \sum_{|e|=1} |\nabla^e f_x|^2,
	\qquad
|\nabla f|^2 = \sum_{x\in\Zd} |\nabla f_x|^2.
\end{equation}
Then by \eqref{e:sbp-gen}
\begin{equation}
\label{e:sbp}
\sum_{x\in\Zd} f_x \Delta f_x
	=
-\frac{1}{2} |\nabla f|^2.
\end{equation}
It follows that
\begin{equation}
\sum_{x\in\Zd} \sum_{e\in\Ucal} f_x f_{x+e}
=
2 d \sum_{x\in\Zd} f_x^2
+ \sum_{x\in\Zd} f_x \Delta f_x
=
2 d \sum_{x\in\Zd} f_x^2
- \frac{1}{2} \sum_{x\in\Zd} |\nabla f_x|^2
\end{equation}
and so we get the useful representation:
\begin{equation}
\label{e:Udef-pos}
U_{\gcc,\gamma}(f)
= (\gcc - \gamma) \sum_{x\in\Zd} f_x^2
+ \frac{\gamma}{4d} \sum_{x\in\Zd} \sum_{e\in\Ucal} |\nabla^e f_x|^2.
\end{equation}
In particular,
\begin{equation}
  \label{e:V2}
  U_{\gcc,\gamma,T} =
  (\gcc - \gamma) I_T
  + \frac{\gamma}{4d}
  |\nabla \lt_T|^2
  .
\end{equation}
% A version of \refeq{V2} can be found in \cite{HK01a}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Predicted behaviour}

We can view the susceptibility \eqref{e:suscept-def} as the partition function
for a measure on walks of \emph{any} length (sometimes called a \emph{grand
ensemble}). When $\nu$ reaches the critical point
\begin{equation}
\nu_c = \nu_c(\gcc, \gamma) = \inf\{ \nu : \chi(\gcc,\gamma,\nu) < \infty \},
\end{equation}
we expect the susceptibility to diverge, which is indicative of a phase transition.
In fact, it is not clear how to show that $\chi(\gcc,\gamma,\nu_c) = \infty$ in
general, although this can be established for $\gamma = 0$
(see \cite[Lemma~\ref{log-lem:csub}]{BBS-saw4-log}). For $\gamma$
sufficiently small, this divergence will be part of our main result.

The two-point function, susceptibility, and correlations lengths of the
self-avoiding walk and (discrete- or continuous-time) WSAW-SA (with $\gamma$ small
depending on $\gcc$) on $\Zd$ are all expected
to scale according to analogues of \eqref{e:Gpred}--\eqref{e:xippred}.
Moreover, the discussion in Section~\ref{sec:asymp} suggests that
\begin{align}
c_T                       &\sim C_5 e^{-\nu_c T} T^{-\gammabar}, \\
\langle |X_T|^2 \rangle   &\sim C_6 T^{-\nubar}.
\end{align}
The critical exponents $\gammabar, \nubar, \eta$ are expected to be universal;
in particular, they should only depend on $d$ in this context.

% Below we discuss some of the predicted and known values of the critical exponents.
Below, we discussion the predicted values of the exponents for $\gamma$ small before
turning our attention to the case of large $\gamma$. A more detailed reference is
\cite{MS93}. The values of $\nubar$ were first predicted\footnote{Flory's prediction
for $d = 3$ is no longer generally accepted.} by the chemist Paul Flory \cite{Flor49}, who
later won the 1974 Nobel Prize in Chemistry for his work on polymers.

\subsubsection{Dimension $d = 1$}

For the SAW, dimension $1$ is trivial: the only self-avoiding walks are straight
lines. This is not the case for the WSAW, see e.g.\ the survey \cite{HK01}.

\subsubsection{Dimension $d = 2$}

In $d = 2$, the predicted values of the critical exponents are
\begin{equation}
\nubar = 3/4, \quad \gammabar = 43/32, \quad \eta = 5/24.
\end{equation}
It was shown in \cite{LSW04} that the scaling limit of SAW, if it exists and
is conformally invariant, is given by $\SLE_{8/3}$, which is consistent with
the predicted exponents given above.

It is not immediately clear how to make sense of the supercritical regime
($\nu < \nu_c$ for WSAW-SA).
However, the authors of \cite{LSW04} considered SAW on a discretized bounded
planar domain. They showed that the scaling limit of supercritical
SAW conditioned to start and end on the boundary of the domain is space-filling
(their results extend to all dimensions $d \ge 2$).

\subsubsection{Dimension $d = 3$}

In $d = 3$, again very little is known. Only numerical approximations for
the critical exponents are available.

\subsubsection{Dimension $d > 4$}

The upper-critical dimensions for these models is $d = 4$ and the mean-field
exponents are the same as for models in the Ising universality class, namely
$\gammabar=1$, $\nubar = 1/2$, $\eta = 0$. In other words, self-avoiding walk
is expected to scale like simple random walk in dimensions above $4$.

In $d > 4$, Brydges and Spencer \cite{BS85} showed that $\nubar = 1/2$ for the
discrete-time WSAW using the lace expansion, which was introduced in the same paper.
By vastly extending this method, Slade \cite{Slad88} showed that the scaling limit
of SAW is Brownian motion and Hara and Slade \cite{HS92a,HS92b} showed that
$\gamma = 1$, $\nubar = 1/2$ (for the mean-squared displacement, correlation length,
and correlation length of order $2$), and $\eta = 0$.

Even above the upper-critical dimension, very little is known about WSAW-SA with
$\gamma \ne 0$. Exceptions include \cite{HH17,Uelt02}.

\begin{rk}
We define the free \emph{bubble diagram} to be the $\ell^2(\Zd)$ norm of the massive
Green function viewed as a function of one variable ($x \mapsto C_{0x}$). Thus, by
\eqref{e:greendef},
\begin{equation}
\label{e:bubble-def}
B_{m^2}
	=
\|C\|_{\ell^2(\Zd)}
	=
(m^2 + 2 d)^{-2} \sum_{m,n=0}^\infty z^{m+n} \Pr(X_m = Y_n),
\end{equation}
where $X$ and $Y$ are independent simple random walks started at $0$. Thus, $B_{m^2}$
is proportional to the expected number of intersections between the traces of two
such random walks \emph{killed} at rate $1 - z$. The upper-critical dimension can
be ``guessed'' as follows. First, we make the convenient definitions
\begin{equation}
\label{e:bubble}
{\sf B}_{m^2} = (n + 8) B_{m^2},
	\quad
{\sf b} = \frac{n + 8}{16\pi^2}.
\end{equation}
Then it is an exercise in Fourier analysis to show that
\begin{equation}
\label{e:bubble-log}
{\sf B}_{m^2}
	\sim
\begin{cases}
{\sf b} \log m^{-2},
	&
d = 4
	\\
{\sf B}_0,
	&
d > 4.
\end{cases}
\end{equation}
\end{rk}

\subsubsection{Dimension $d = 4$}

As discussed in Section~\ref{sec:rg-intro}, Bauerschmidt, Brydges, and Slade have
recently made great strides in the case $d = 4$ using a renormalisation group method.
One of the novelties of this method, besides its applicability to multi-component
spin systems, is that it can be used to study the WSAW via an integral representation
we will discuss in Section~\ref{sec:intrep}. This method was first applied to walks
in \cite{BBS-saw4-log,BBS-saw4}, where the susceptibility and two-point function were
studied.

\subsubsection{Phase diagram}

Let $d \ge 2$. The predicted behaviour of self-avoiding walk with attraction is discussed
in \cite{Vand98}.
When $\gamma$ reaches the $\theta$-curve in Figure~\REF, it is predicted
that the value of $\nubar$ changes discontinuously to $\nubar_\theta = 4/7$ if $d = 2$
and $\nubar_\theta = 1/2$ if $d \ge 3$. The predicted values for $\nubar$
in the other regions of the phase diagram are shown in the figure. In particular, for
$\gamma > \beta$, the WSAW-SA is expected to undergo a collapse transition ($\nubar = 0$).
This has recently been shown for a model of prudent self-avoiding walk with self-attraction
in \cite{PT16}.

\commentbw{Insert phase diagram}
